<!DOCTYPE html>
<html lang="en">

<head th:replace="~{fragementHead:: headTagFragment}"></head>
<head>
    <!-- Module CSS -->
    <link rel="stylesheet" href="/css/material.css">
</head>

<body class="sb-nav-fixed">

<nav th:replace="~{fragementNavBars :: topNavFragment}"></nav>
<div id="layoutSidenav">
    <div id="layoutSidenav_nav">
        <nav th:replace="~{fragementNavBars :: sideNavFragment}"></nav>
    </div>
    <div id="layoutSidenav_content">
        <main style="margin-top: 22px">
            <div class="container-fluid px-4">

                <div class="tab">
                    <ul class="nav nav-tabs nav-pills" id="myTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="formTabButton" data-bs-toggle="tab"
                                    data-bs-target="#form-tab-pane"
                                    type="button" role="tab" aria-controls="form-tab-pane" aria-selected="true">Add
                                Material
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="tableTabButton" data-bs-toggle="tab"
                                    data-bs-target="#table-tab-pane"
                                    type="button" role="tab" aria-controls="table-tab-pane" aria-selected="false">
                                Material List
                            </button>
                        </li>
                    </ul>
                </div>
                <div class="tab-content">
                    <div class="tab-pane fade show active" id="form-tab-pane" role="tabpanel" aria-labelledby="form-tab"
                         tabindex="0">
                        <!-- Form Start -->
                        <div class="row mt-2">
                            <div class="row-cols-md-1"></div>
                            <!-- Table Start -->
                            <div class="row-cols-md-10">
                                <form onsubmit="return false" id="formMaterial">
                                    <!-- Auto Generated Material No -->
                                    <div class="row mt-1 ">
                                        <div class="d-flex justify-content-start">
                                            <div class="div col-6">
                                                <!-- Material No -->
                                                <div class="row d-flex">
                                                    <div class="col-4">
                                                        <label for="inputMaterialNo" class="form-label fw-bold">
                                                            Material No. : <span class="text-danger">*</span>
                                                        </label>
                                                    </div>
                                                    <div class="col-7">
                                                        <input type="text" class="form-control"
                                                               placeholder="Auto Generated Material No."
                                                               id="inputMaterialNo" required disabled>
                                                    </div>
                                                </div>
                                                <!-- Material No End-->
                                            </div>
                                            <div class="col-4"></div>
                                            <!-- Required Label-->
                                            <div class="col-1">
                                                <span class="required"><span class="text-danger">*</span>Required</span>
                                            </div>
                                            <!-- back button section-->
                                            <div class="col-1" id="backButtonDivFormFirst">
                                                <button type="button" style="width: 100px;"
                                                        class="btn text-primary btn-lg"
                                                        onclick="backButtonMaterialForm()">
                                                    <i class="fa-regular fa-rectangle-xmark fa-xl"></i>
                                                </button>
                                            </div>
                                            <!-- back button section-->
                                            <!-- Required Label End-->
                                        </div>
                                    </div>
                                    <!-- Auto Generated Material No End-->
                                    <div id="formEditable">
                                        <!-- form onsubmit return is used to stop auto submission and then to force a manual submission -->
                                        <!-- Material Name And Category -->
                                        <div class="row mt-1 gy-2">
                                            <div class="d-flex justify-content-between">
                                                <!-- Material Category -->
                                                <div class="col-6">
                                                    <div class="row d-flex justify-content-start">
                                                        <div class="col-4">
                                                            <label for="inputMaterialCategory"
                                                                   class="form-label fw-bold">
                                                                Material Category : <span class="text-danger">*</span>
                                                            </label>
                                                        </div>
                                                        <div class="col-6 d-flex">
                                                            <div class="col-12 justify-content-start">
                                                                <select type="select" class="form-control"
                                                                        placeholder="Select Material Category"
                                                                        id="inputMaterialCategory"
                                                                        onchange="selectDynamicValidator(this,'material','material_category_id')">
                                                                </select>
                                                                <div class="valid-feedback"></div>
                                                                <div class="invalid-feedback">Please Select Material
                                                                    Category..!
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-2 d-flex align-items-center">
                                                            <!-- Button trigger modal -->
                                                            <button type="button" class="btn btn-outline-dark btn-sm"
                                                                    data-bs-toggle="modal"
                                                                    data-bs-target="#materialCategoryBackdrop"
                                                                    title="Click Here To Add New Material Category">
                                                                <i class="fa-solid fa-plus"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Material Category End-->
                                                <!-- Material Name -->
                                                <div class="col-6">
                                                    <div class="row d-flex justify-content-start">
                                                        <div class="col-4">
                                                            <label for="inputMaterialName" class="form-label fw-bold">
                                                                Material Name : <span class="text-danger">*</span>
                                                            </label>
                                                        </div>
                                                        <div class="col-7">
                                                            <input type="text" class="form-control"
                                                                   placeholder="Enter Material Name"
                                                                   id="inputMaterialName"
                                                                   onkeyup="textValidator(this,'^(([A-Za-z0-9#%@/\\()\\-\\_\\s.]{2,30}))$','material', 'name')">
                                                            <div class="valid-feedback"></div>
                                                            <div class="invalid-feedback">Please Enter a valid Material
                                                                name..!
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Material Name Ends-->
                                            </div>
                                        </div>
                                        <!-- Material Name And Category End -->


                                        <!-- Material Unit Type and Unit Cost -->
                                        <div class="row mt-1 gy-2">
                                            <div class="d-flex justify-content-between">
                                                <!-- Material Unit Type -->
                                                <div class="col-6">
                                                    <div class="row d-flex justify-content-start">
                                                        <div class="col-4">
                                                            <label for="inputMaterialUnitType"
                                                                   class="form-label fw-bold">
                                                                Material Unit Type : <span class="text-danger">*</span>
                                                            </label>
                                                        </div>
                                                        <div class="col-6 d-flex">
                                                            <div class="col-12 justify-content-start">
                                                                <select type="select" class="form-control"
                                                                        placeholder="Select Material Unit Type"
                                                                        id="inputMaterialUnitType"
                                                                        onchange="selectDynamicValidator(this,'material','material_unit_type_id')">
                                                                </select>
                                                                <div class="valid-feedback"></div>
                                                                <div class="invalid-feedback">Please Select Material
                                                                    Unit
                                                                    Type..!
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-2 d-flex align-items-center">
                                                            <!-- Button trigger modal -->
                                                            <button type="button" class="btn btn-outline-dark btn-sm"
                                                                    data-bs-toggle="modal"
                                                                    data-bs-target="#materialUnitTypeBackdrop"
                                                                    title="Click Here To Add New Material Unit Type">
                                                                <i class="fa-solid fa-plus"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Material Unit Type End-->
                                                <!-- Material Unit Cost -->
                                                <div class="col-6">
                                                    <div class="row d-flex justify-content-start">
                                                        <div class="col-4">
                                                            <label for="inputMaterialUnitCost"
                                                                   class="form-label fw-bold">
                                                                Unit Cost (LKR) : <span class="text-danger">*</span>
                                                            </label>
                                                        </div>
                                                        <div class="col-7">
                                                            <input type="text" class="form-control"
                                                                   placeholder="Enter Material Unit Cost"
                                                                   id="inputMaterialUnitCost" maxlength="8"
                                                                   onkeyup="textValidator(this,'^(([0-9]{1,6})|([0-9]{1,6}[\\.][0-9]{2}))?$','material', 'unit_cost')">
                                                            <div class="valid-feedback"></div>
                                                            <div class="invalid-feedback">Please Enter a valid Material
                                                                Unit
                                                                Cost or Set it to 0..!
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Material Unit Cost Ends-->
                                            </div>
                                        </div>
                                        <!--  Material Unit Type and Unit Cost End -->

                                        <!-- Material Re-Order Point and Profit Percentage -->
                                        <div class="row mt-1 gy-2">
                                            <div class="d-flex justify-content-between">
                                                <!-- Material ROP -->
                                                <div class="col-6">
                                                    <div class="row d-flex justify-content-start">
                                                        <div class="col-4">
                                                            <label for="inputMaterialROP"
                                                                   class="form-label fw-bold"
                                                                   title="Material Re-Order Point">
                                                                Material ROP : <span class="text-danger">*</span>
                                                            </label>
                                                        </div>
                                                        <div class="col-7 d-flex">
                                                            <div class="col-11 justify-content-start">
                                                                <input type="text" class="form-control"
                                                                       placeholder="Enter Material Re-Order Point"
                                                                       id="inputMaterialROP" maxlength="8"
                                                                       title="Enter Material Re-Order Point"
                                                                       onkeyup="textValidator(this,'^(([1-9])|([1-9][0-9]{1,2}))$','material', 'reorder_point')">
                                                                <div class="valid-feedback"></div>
                                                                <div class="invalid-feedback">Material Re-Order Point is
                                                                    not
                                                                    valid..!
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Material ROP End-->
                                                <!-- Material Profit Percentage -->
                                                <div class="col-6">
                                                    <div class="row d-flex justify-content-start">
                                                        <div class="col-4">
                                                            <label for="inputProfitPercentage"
                                                                   class="form-label fw-bold">
                                                                Material Profit(%) : <span class="text-danger">*</span>
                                                            </label>
                                                        </div>
                                                        <div class="col-7">
                                                            <input type="text" class="form-control"
                                                                   placeholder="Enter Material Profit Percentage"
                                                                   id="inputProfitPercentage" maxlength="5"
                                                                   onkeyup="textValidator(this,'^(([1-9][\\.][0-9]{1})|([1-9])|([1-9][0-9]{1,2})|([1-9][0-9]{1,5}[\\.][0-9]{1}))$','material', 'profit_percentage')">
                                                            <div class="valid-feedback"></div>
                                                            <div class="invalid-feedback">Please Enter a valid Material
                                                                Profit
                                                                Percentage..!
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Material Profit Percentage Ends-->

                                            </div>
                                        </div>
                                        <!--  Material Re-Order Point and Profit Percentage End -->

                                        <!-- Material Status and Unit Price -->
                                        <div class="row mt-1 gy-2">
                                            <div class="d-flex justify-content-between">
                                                <!-- Material Status -->
                                                <div class="col-6">
                                                    <div class="row d-flex justify-content-start">
                                                        <div class="col-4">
                                                            <label for="inputMaterialStatus" class="form-label fw-bold">
                                                                Material Status : <span class="text-danger">*</span>
                                                            </label>
                                                        </div>
                                                        <div class="col-7 d-flex">
                                                            <div class="col-11 justify-content-start">
                                                                <select type="select" class="form-control"
                                                                        placeholder="Select Material Status"
                                                                        id="inputMaterialStatus" disabled>
                                                                </select>
                                                                <div class="valid-feedback"></div>
                                                                <div class="invalid-feedback">Please Select Material
                                                                    Status..!
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Material Status End-->
                                                <!-- Material Unit Price -->
                                                <div class="col-6">
                                                    <div class="row d-flex justify-content-start">
                                                        <div class="col-4">
                                                            <label for="inputMaterialUnitPrice"
                                                                   class="form-label fw-bold">
                                                                Unit Price (LKR) : <span class="text-danger">*</span>
                                                            </label>
                                                        </div>
                                                        <div class="col-7">
                                                            <input type="text" class="form-control"
                                                                   placeholder="Auto-Filled Material Market Price"
                                                                   id="inputMaterialUnitPrice" maxlength="8" disabled>
                                                            <div class="valid-feedback"></div>
                                                            <div class="invalid-feedback"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Material Unit Price Ends-->

                                            </div>
                                        </div>
                                        <!--  Material Status and Unit Price End -->

                                        <div id="StockSection" style="display: none; ">
                                            <!-- Current Unit Stock And Last Stock Intake -->
                                            <div class="row mt-1 gy-2">
                                                <div class="d-flex justify-content-between">
                                                    <!-- Current Unit Stock -->
                                                    <div class="col-4">
                                                        <div class="row d-flex justify-content-start">
                                                            <label for="inputCurrentUnitStock"
                                                                   class="form-label fw-bold">
                                                                Current Unit Stock : <span class="text-danger">*</span>
                                                            </label>
                                                            <div class="col-11 justify-content-start">
                                                                <input type="text" class="form-control"
                                                                       placeholder="Enter Current Unit Stock"
                                                                       id="inputCurrentUnitStock" maxlength="8"
                                                                       autocomplete="off"
                                                                       onkeyup="textValidator(this,'^(([1-9][0-9]{0,6}))$','material','current_unit_stock')">
                                                                <div class="valid-feedback"></div>
                                                                <div class="invalid-feedback">Please Enter a valid
                                                                    Current Unit
                                                                    Stock..!
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- Current Unit Stock End-->
                                                    <!-- Last Stock Intake -->
                                                    <div class="col-4">
                                                        <div class="row d-flex justify-content-start">
                                                            <label for="inputLastStockIntake"
                                                                   class="form-label fw-bold">
                                                                Last Stock Intake :
                                                            </label>
                                                            <div class="col-11 justify-content-start">
                                                                <input type="text" class="form-control"
                                                                       placeholder="Auto-Filled Last Stock Intake"
                                                                       id="inputLastStockIntake"
                                                                       onkeyup="textValidator(this,'^([1-9][0-9]{0,20})$','material','last_stock_intake')">
                                                                <div class="valid-feedback"></div>
                                                                <div class="invalid-feedback">Please Enter a valid
                                                                    number..!
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- Last Stock Intake End-->
                                                    <!-- All Time Total Stock -->
                                                    <div class="col-4">
                                                        <div class="row d-flex justify-content-start">
                                                            <label for="inputAllTimeTotal" class="form-label fw-bold">
                                                                All Time Total Stock :
                                                            </label>
                                                            <div class="col-11 justify-content-start">
                                                                <input type="text" class="form-control"
                                                                       placeholder="Auto-Filled All Time Total Stock"
                                                                       id="inputAllTimeTotal"
                                                                       onkeyup="textValidator(this,'^([1-9][0-9]{0,20})$','material','all_time_total_stock')">
                                                                <div class="valid-feedback"></div>
                                                                <div class="invalid-feedback">Please Enter a valid
                                                                    number..!
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- All Time Total Stock End-->
                                                </div>
                                            </div>
                                            <!-- Current Unit Stock And Last Stock Intake End -->


                                        </div>

                                        <!-- Description -->
                                        <div class="row mt-1 gy-2">
                                            <div class="d-flex justify-content-between">
                                                <div class="col-12">
                                                    <div class="row d-flex justify-content-start">
                                                        <div class="col-2">
                                                            <label for="inputMaterialDesicription"
                                                                   class="form-label fw-bold">
                                                                Description
                                                                :</label>
                                                        </div>
                                                        <div class="col-4">
                                                            <textarea class="form-control"
                                                                      id="inputMaterialDesicription" cols="30" rows="2"
                                                                      onkeyup="textValidator(this,'^([A-Za-z0-9%^&*?/$#@!\\()\\s\\.]{2,35})+$','material','description')"
                                                                      placeholder="Enter Description"></textarea>
                                                            <div class="valid-feedback"></div>
                                                            <div class="invalid-feedback">Please Enter a valid
                                                                Description..!
                                                            </div>
                                                        </div>
                                                        <div class="col-6">
                                                            <!-- Material ROQ -->
                                                                <div class="row d-flex justify-content-start">
                                                                    <div class="col-4">
                                                                        <label for="inputMaterialROQ"
                                                                               class="form-label fw-bold"
                                                                               title="Material Re-Order Point">
                                                                            Material ROQ : <span class="text-danger">*</span>
                                                                        </label>
                                                                    </div>
                                                                    <div class="col-7 d-flex">
                                                                        <div class="col-11 justify-content-start">
                                                                            <input type="text" class="form-control"
                                                                                   placeholder="Enter Material Re-Order Quantity"
                                                                                   id="inputMaterialROQ" maxlength="8"
                                                                                   title="Enter Material Re-Order Point"
                                                                                   onkeyup="textValidator(this,'^(([3-9][0-9])|([1-9][0-9][0-9]{1,2}))$','material', 'reorder_quantity')">
                                                                            <div class="valid-feedback"></div>
                                                                            <div class="invalid-feedback">Material Re-Order Quantity is not
                                                                                valid..!
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            <!-- Material ROQ End-->
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Description End -->

                                        <div class="row mt-3">
                                            <div class="col-1">
                                                <button type="reset" id="formRestBtn"
                                                        class=" btn fw-bold btn-reset formClearBtn"
                                                        onclick="ClearMaterialFormButtonFunction()">
                                                    Clear
                                                </button>
                                            </div>
                                            <div class="col-9"></div>
                                            <div class="col-1">
                                                <button type="submit" id="formUpdateBtn"
                                                        onclick="buttonMaterialUpdate()"
                                                        class=" btn fw-bold btn-update formUpdateBtn">
                                                    Update
                                                </button>
                                            </div>
                                            <div class="col-1">
                                                <button type="submit" id="formAddBtn" onclick="submitMaterial()"
                                                        class="btn btn-primary fw-bold btn-add formAddBtn">
                                                    Add
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <!-- Form End -->
                    </div>
                    <div class="tab-pane fade" id="table-tab-pane" role="tabpanel" aria-labelledby="table-tab"
                         tabindex="1">
                        <!-- Table Area Start -->
                        <div class="row mt-2">
                            <div class="row-cols-md-1"></div>
                            <div class="row-cols-md-10 table-responsive" style="width: 100%;">
                                <!-- Table Start -->
                                <div class="tableDiv">
                                    <table class="table table-hover" id="tableMaterial">
                                        <thead class="table-active">
                                        <tr>
                                            <th>#</th>
                                            <th>Mat No.</th>
                                            <th>Name</th>
                                            <th>Category</th>
                                            <th>Status</th>
                                            <th>Current Stoke</th>
                                            <th>Modify</th>
                                        </tr>
                                        </thead>
                                        <tbody id="tbodyMaterial">

                                        </tbody>
                                    </table>
                                </div>
                                <!-- Table End -->
                            </div>
                            <div class="row-cols-md-1"></div>
                        </div>
                        <!-- Table Area End -->
                    </div>

                </div>

                <!-- Inner Form Modals For Material Category and Unit Type -->

                <!-- Modal Material Category-->
                <div class="modal fade " id="materialCategoryBackdrop" data-bs-backdrop="static"
                     data-bs-keyboard="false"
                     tabindex="-1" aria-labelledby="materialCategoryBackdropLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="materialCategoryBackdropLabel">Add New Material
                                    Category</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
                                        id="closeMatCatModal" onclick="closeBtnMaterialCategory();"></button>
                            </div>
                            <div class="modal-body">
                                <!-- Material Category -->
                                <div class="row" style="padding-left: 25px;">
                                    <div class="row d-flex justify-content-start">
                                        <label for="inputMaterialCategoryName" class="form-label fw-bold">
                                            Category Name : <span class="text-danger">*</span>
                                        </label>
                                        <input type="text" class="form-control" placeholder="Enter Material Category"
                                               id="inputMaterialCategoryName"
                                               onkeyup="textValidator(this,'^(([A-Za-z\\-\\_\\s]{2,30}))$','material_category', 'name')">
                                        <div class="valid-feedback"></div>
                                        <div class="invalid-feedback">Please Enter a valid Material Category Name..!
                                        </div>
                                    </div>

                                </div>
                                <!-- Material Category Ends-->
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-outline-danger" id="clearBtnMatCategory"
                                        onclick="closeBtnMaterialCategory();">Clear
                                </button>
                                <button type="button" class="btn btn-outline-primary" id="addMaterialCategoryModalBtn"
                                        onclick="submitNewMaterialCategory();">Add Category
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Modal Material Category Ends-->

                <!-- Modal Material Unit Type -->
                <div class="modal fade " id="materialUnitTypeBackdrop" data-bs-backdrop="static"
                     data-bs-keyboard="false"
                     tabindex="-1" aria-labelledby="materialUnitTypeBackdropLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="materialUnitTypeBackdropLabel">Add New Material Unit
                                    Type</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
                                        id="closeMatUnitModal" onclick="closeBtnMaterialUnitType();"></button>
                            </div>
                            <div class="modal-body">
                                <!-- Material Unit Type Name -->
                                <div class="row" style="padding-left: 25px;">
                                    <div class="row d-flex justify-content-start">
                                        <label for="inputMaterialUnitTypeName" class="form-label fw-bold">
                                            Unit Type Name : <span class="text-danger">*</span>
                                        </label>
                                        <input type="text" class="form-control" placeholder="Enter Material Unit Name"
                                               id="inputMaterialUnitTypeName"
                                               onkeyup="textValidator(this,'^(([A-Za-z\\-\\_\\s]{2,30}))$','material_unit_type', 'name')">
                                        <div class="valid-feedback"></div>
                                        <div class="invalid-feedback">Please Enter a valid Material Unit Name..!
                                        </div>
                                    </div>
                                </div>
                                <!-- Material Unit Type Name Ends-->
                                <!-- Material Unit Type Symbol -->
                                <div class="row" style="padding-left: 25px;">
                                    <div class="row d-flex justify-content-start">
                                        <label for="inputMaterialUnitTypeSymbol" class="form-label fw-bold">
                                            Unit Type Symbol : <span class="text-danger">*</span>
                                        </label>
                                        <input type="text" class="form-control" placeholder="Enter Material Unit Symbol"
                                               id="inputMaterialUnitTypeSymbol"
                                               onkeyup="textValidator(this,'^(([A-Za-z\\s.]{1,4}))$','material_unit_type', 'symbol')">
                                        <div class="valid-feedback"></div>
                                        <div class="invalid-feedback">Please Enter a valid Material Unit Type Symbol...!
                                        </div>
                                    </div>
                                </div>
                                <!-- Material Unit Type Symbol-->
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-outline-danger" id="clearBtnMatUnitType"
                                        onclick="closeBtnMaterialUnitType();">Clear
                                </button>
                                <button type="button" class="btn btn-outline-primary" id="addMaterialUnitTypeModalBtn"
                                        onclick="submitNewMaterialUnitType();">Add Unit Type
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Modal Material Unit Type Ends-->

                <!-- Inner Form Modals For Material Category and Unit Type Ends-->

                <script src="script/commonFunction.js"></script>
                <script src="script/tableCommonFunctions.js"></script>
                <script src="script/validation.js"></script>
                <script src="controllerjs/material.js"></script>
            </div>
        </main>
    </div>
</div>
<script src="script/dashboard.js"></script>
</body>


</html>